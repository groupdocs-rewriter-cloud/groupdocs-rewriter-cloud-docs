name: build
on:
  push:
    branches:
      - main
    paths-ignore:
        '.github/**'
  # Triggers the workflow on pull
  pull_request:
  # Run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  job-one:
    name: Deploy
    runs-on: [self-hosted, linux, x64, dev4-runner]
    steps:
      - name: Checkout
        uses: actions/checkout@v3
        with:
          submodules: 'true'

      - name: hugo build
        run: |
          mkdir -p docs-cloud-common/content/${{ env.PRODUCT }}
          cp -r rewriter docs-cloud-common/content/${{ env.PRODUCT }}
          cp _index.md docs-cloud-common/content/${{ env.PRODUCT }}
          hugo --source docs-cloud-common --minify --config config.toml,ignore-total-config.toml